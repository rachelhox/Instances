<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script
    src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
    crossorigin="anonymous"
  ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp" crossorigin="anonymous">

    <title>My Events | Instances</title>

    <link rel="stylesheet" href="/styling/general.css">
    <link rel="stylesheet" href="/styling/myEvents.css"/>
</head>
<body>

<%# ------------- Nav Bar ------------- %>
    <%- include('partials/nav'); %>

<%# ------------- Page Title ------------- %>

<div class="maxWidthContainer">
    <div class="titleContainer">
                <h2>My Events</h1>
        </div>

<%# ------------- Event Card ------------- %>

<% if (data !== null) {%> 
    <% data.map(x => { %>

    <div class="largeCardContainer">
            <div class="row cardContainer">
                <div class="col-8">
                    <div class="row rows">
    <%# ------------- Small Cards for each Category ------------- %>

                        <div class=" col-5 dashCardContainer">
                            <div class="cards">
                                <div class="col-12 dashCardTitle">
                                    Event
                                </div>
                                <div class="col-12 dashCardContentContainer">
                                        <div class="dashCardContent1" id="eventName">
                                            <%=x.name%>
                                        </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-7 dashCardContainer">
                            <div class="cards">
                                <div class="col-12 dashCardTitle">
                                    <%# !!! DATA FROM SERVER !!! %>
                                    Event Photo
                                    <a href="" data-id='eventName' id="editPhoto" class="btn editPhotoBtn" data-toggle="modal" data-target="#modalEventPictureForm">Edit</a>
                                </div>
                                <div class="photoCard col-12" style="background-image: url(<%=x.photo%>);">
                
                                </div>
                               <%# <i class="far fa-image iconPlacing fa-9x"></i> %>
                            </div>
                        </div>

                    </div>

                    <div class="row rows">
                        <div class="col-4 dashCardContainer">
                            <div class="cards">

                                <%#  <i class="far fa-calendar-minus iconPlacing fa-9x"></i> %>
                                    <div class="col-12 dashCardTitle">
                                        <%# !!! DATA FROM SERVER !!! %>
                                        Date
                                    </div>
                                    <div class="dashCardContentContainer">
                                        <div class="col-12 dashCardContent2" id="dateFont">
                                            <%=x.date%>
                                        </div>
                                    </div>

                            </div>
                        </div>
                        <div class="col-4 dashCardContainer">
                            <div class="cards">
                                <div class="col-12 dashCardTitle">
                                    Location
                                </div>
                                <div class="dashCardContentContainer">
                                    <div class="col-12 dashCardContent2">
                                        <%=x.location%>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-4 dashCardContainer">
                            <div class="cards">
                                <div class="col-12 dashCardTitle">
                        
                                    Category
                                </div>
                                <div class="dashCardContentContainer">
                                    <div class="col-12 dashCardContent2">
                                        <%=x.categories%>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row rows">
                        <div class="col-4 dashCardContainer">
                            <div class="cards">
                                <div class="col-12 dashCardTitle">
                                    
                                    Max-Participants
                                </div>
                                <div class="dashCardContentContainer">
                                    <div class="col-12 dashCardContent2">
                                        <%=x.max_participants%>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-8 dashCardContainer">
                            <div class="cards">
                                <div class="col-12 dashCardTitle">
                                    Description
                                </div>
                                <div class="col-12 dashCardContent3">
                                    <%=x.description%>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

<%# ------------- Right Column ------------- %>

                <div class="col-4">
                    <div class="row rightRows">

        <%# ------------- Joined List Card ------------- %>

                            <div class="col-12 dashCardContainer">
                                <div class="cards">
                                    <div class="col-12 listTitle">
                                        Joined List
                                    </div>
                                    <div>
                                        <ul class="memberList">

                <%# ------------- One Row of the List ------------- %>
                <% if (accepteddata.length > 0) {%> 
                    <% accepteddata.map(z => { %>
                                            <li>
                                                <div class="row memberRow">
                                                    <div class="col-7"><%=z.nickname%></div>
                                                    <div class="col-3">
                                                        <div class="memberPic" style="background-image: url(<%=z.photo%>);">
                                                        </div>
                                                    </div>
                                                    <a class="col-2 iconContainer" type="submit" href="" data-target=""> <i class="fas fa-times"></i> <%#UserPicURL%></a>
                                                </div>
                                            </li>
                                            <%});   }%>
                
                                        </ul>
                                    </div>
                                </div>
                            </div>
                    </div>
        <%# ------------- Request to Join List Card ------------- %>        
                    <div class="row rightRows">
                        <div class="col-12 dashCardContainer">
                            <div class="cards">
                                <div class="col-12 listTitle">
                                    Requesting to Join
                                </div>
                                <% if (waitingdata.length > 0) {%> 
                                    <% waitingdata.map(y => { %>
                                <div>
                                    <ul class="memberList">
                                        <li>
                                            <div class="row memberRow">
                                                <div class="col-6"><%=y.nickname %></div>
                                                <div class="col-3">
                                                    <div class="memberPic" style="background-image: url(<%=y.photo%>);">
                                                        <%# !!! DATA FROM SERVER !!! %>
                                                    </div>
                                                </div>
                                                <form 
                                                    action="/changestatus/<%=username%>/<%=id%>/<%=eventId%>"
                                                    method="post">
                                                    <input style="visibility:hidden" type="submit" id="joinB" name="requesting_users_id" value=<%=y.id%> />
                                                    <label for="joinB"><i class="fas fa-check"></i></label>
                                                    
                                                   </form>
                                                <a class="col-1.5 iconContainer" href="" type="submit" data-target=""> <i class="fas fa-times"></i> <%# !!! DATA FROM SERVER !!! %></a>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                                <%});   }%>
                            </div>
                        </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <a href="" class="btn" data-toggle="modal" data-target="#modalRegisterForm">Edit Event</a>
                    </div>
                    <div class="col-6">
                        <form action="/enterChatroom" method="get">
                        <input name="joinevents" class="d-none" value=""/>
                        <input type="submit" class="btn" value="Join Chat" name="button"/>
                        </form>
                    </div>
                </div>
                    
                    
                </div>
            </div>
    </div>

<%# --------------- EDIT MODAL --------------- %>

<div class="modal fade" id="modalRegisterForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
aria-hidden="true">
<div class="modal-dialog modal-dialog-centered" role="document">
  <div class="modal-content">
    <div class="modal-header text-center">
      <h4 class="modal-title w-100 font-weight-bold">Edit Your Event</h4>
      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="modal-body mx-3">
      <div class="md-form mb-3">

        <label data-error="wrong" data-success="right" for="">Event Name</label>
        <input type="text" class="form-control validate" required placeholder="Fetch data from server <%# %>">
      </div>

      <div class="md-form mb-3">
        <label data-error="wrong" data-success="right" for="">Date</label>
        <input type="date" class="form-control validate" placeholder="Fetch data from server <%# %>">
      </div>

      <div class="md-form mb-3">
        <label data-error="wrong" data-success="right" for="">Location</label>
        <select type="text" class="form-control validate" placeholder="Fetch data from server <%# %>">
            <option value="Hong Kong">Hong Kong</option>
            <option value="Kowloon">Kowloon</option>
            <option value="New Territories">New Territories</option>
        </select>
      </div>

      <div class="md-form mb-3">
        <label data-error="wrong" data-success="right" for="">Category</label>
        <select type="text" class="form-control validate" <%# %>>
            <option value="Movies">Movies</option>
            <option value="Eat Out">Eat Out</option>
            <option value="Outdoors">Outdoors</option>
            <option value="Music">Music</option>
            <option value="Local Tours">Local Tours</option>
            <option value="Night Out">Night Out</option>
        </select>
      </div>

      <div class="md-form mb-3">
        <label data-error="wrong" data-success="right" for="">Max Pax</label>
        <select type="text" class="form-control validate">
            <option value="2">2 persons</option>
            <option value="3">3 persons</option>
            <option value="4">4 persons</option>
            <option value="5">5 persons</option>
            <option value="6">6 persons</option>
        </select>
      </div>

      <div class="md-form mb-3">
        <label data-error="wrong" data-success="right" for="">Description</label>
        <input type="text" class="form-control validate" placeholder="Fetch data from server <%# %>">
      </div>

    </div>
    <div class="modal-footer d-flex justify-content-center">
      <button class="btn btnSave" type="submit">Save Profile</button>
    </div>
  </div>
</div>
</div>

<%# --------------- EDIT EVENT PHOTO MODAL --------------- %>


    <div class="modal fade" id="modalEventPictureForm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">

            <div class="modal-header text-center">
            <h4 class="modal-title w-100 font-weight-bold">Edit Your Event Picture</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
            </div>

            <div class="modal-body mx-3">
                <div class="md-form mb-5">
                    <i class="fas fa-user prefix grey-text"></i>
                    <label data-error="wrong" data-success="right" >Upload Your Photo</label>
                    <input type="file"   class="form-control validate" placeholder="">
                </div>

            </div>
            <div class="modal-footer d-flex justify-content-center" id="uploadPhoto">
            <!-- <button class="btn btn-deep-orange btnSave" type="submit" id="uploadPhoto" value="Upload">Save Profile Picture</button> -->
            </div>
        </div>
        </div>
    </div>
    <%});   %>
    <%  } else {%>
      <h2>You haven't Created any events at the moment</h2>
    <%  }       %>

    <script src="/javascript/createEventPhoto.js"></script>
    <script src="/javascript/general.js"></script>
   

</body>
</html>